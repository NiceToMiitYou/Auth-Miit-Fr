<% //'Login form with transition to display' %>
<div ng-controller="LoginController"
     ng-class="{ starting: true }"
     class="row login-container">  

    <div class="col s12 offset-m3 m6">
        <div class="card">

            <form id="login" name="login" class="col s12">

                <div class="card-content">

                    <% //'Logo of the conference' %>

                    <% if( conference.logo ) { %>
                    <div class="row">
                        <div class="col s12 center-align">
                            <img src="<%= conference.logo %>"
                                 class="responsive-img"
                                 width="200"/>
                        </div>
                    </div>
                    <% } %>

                    <% //'Email field' %>

                    <div class="row">
                        <div class="input-field col s12">

                            <input id="email"
                                   name="email"
                                   ng-model="user.mail"
                                   ng-pattern="/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/"
                                   ng-class="{
                                        invalid: (
                                                    login.email.$viewValue &&
                                                    !login.email.$valid ||
                                                    user.exist &&
                                                    user.need_account
                                                ),
                                        valid: ( 
                                                    user.mail &&
                                                    login.email.$valid &&
                                                    !(
                                                        user.exist &&
                                                        user.need_account
                                                    )
                                                )
                                   }"
                                   ng-change="reset()"
                                   ng-disabled="request_send"
                                   type="text"
                                   required>

                            <label for="email">
                                <%= __('login.form.enter_email') %>
                            </label>

                        </div>
                    </div>

                    <% //'Need accound field' %>

                    <div class="row">
                        <div class="input-field col s12">

                            <input id="need_account"
                                   name="need_account"
                                   ng-model="user.need_account"
                                   ng-change="reset()"
                                   ng-disabled="request_send"
                                   type="checkbox">

                            <label for="need_account">
                                <%= __('login.form.need_account') %>
                            </label>

                        </div>
                    </div>

                    <% //'Password field' %>

                    <div class="row">
                        <div class="input-field col s12">

                            <input id="password"
                                   name="password"
                                   ng-model="user.password"
                                   ng-class="{ 
                                        invalid: ( 
                                                    user.password &&
                                                    user.password.length < 6 ||
                                                    user.wrong
                                                ),
                                        valid: (
                                                    user.password.length >= 6 &&
                                                    !user.wrong
                                                )
                                   }"
                                   ng-change="reset()"
                                   ng-disabled="request_send"
                                   type="password"
                                   required>

                            <label for="password">
                                <%= __('login.form.enter_password') %>
                            </label>

                        </div>
                    </div>

                    <% //'Confirm field' %>

                    <div class="row">
                        <div class="input-field col s12 animate-show" ng-show="user.need_account">

                            <input id="confirm_password"
                                   name="confirm_password"
                                   ng-model="user.confirm"
                                   ng-class="{ 
                                        invalid: ( 
                                                    user.confirm &&
                                                    (
                                                        user.confirm !== user.password ||
                                                        user.confirm.length < 6
                                                    )
                                                ),
                                        valid: ( 
                                                    user.confirm === user.password &&
                                                    user.confirm.length >= 6
                                                )
                                   }"
                                   ng-change="reset()"
                                   ng-disabled="request_send"
                                   type="password"
                                   required>

                            <label for="confirm_password">
                                <%= __('login.form.confirm_password') %>
                            </label>

                        </div>
                    </div>

                    <% //'CGU field' %>

                    <div class="row">
                        <div class="input-field col s12">

                            <input id="cgu"
                                   name="cgu"
                                   ng-model="cgu"
                                   ng-disabled="request_send"
                                   type="checkbox">

                            <label for="cgu">
                                <%- __('login.form.accept_cgu') %>
                            </label>

                        </div>
                    </div>

                    <% //'Button field' %>

                    <div class="row">
                        <div class="col s12 center-align margin-top-20">

                            <a class="btn-flat"
                               ng-class="{
                                    disabled:        disabled(),
                                    'waves-effect': !disabled()
                               }"
                               ng-click="processed()">
                                {{
                                    user.need_account ?
                                    "<%= __('login.form.register') %>" :
                                    "<%= __('login.form.connection') %>"
                                }}
                            </a>

                        </div>
                    </div>
                </div>
            </form>

            <% //'Progressbar' %>

            <div class="overflow" ng-show="request_send">

                <div class="full-height valign-wrapper">
                    <div class="valign">

                        <div class="preloader-wrapper big active">

                            <div class="spinner-layer spinner-blue">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                    </div><div class="gap-patch">
                                    <div class="circle"></div>
                                    </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                            <div class="spinner-layer spinner-red">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                    </div><div class="gap-patch">
                                    <div class="circle"></div>
                                    </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                            <div class="spinner-layer spinner-yellow">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                    </div><div class="gap-patch">
                                    <div class="circle"></div>
                                    </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                            <div class="spinner-layer spinner-green">
                                <div class="circle-clipper left">
                                    <div class="circle"></div>
                                    </div><div class="gap-patch">
                                    <div class="circle"></div>
                                    </div><div class="circle-clipper right">
                                    <div class="circle"></div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>

</div>